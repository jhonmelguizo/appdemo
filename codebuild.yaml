steps:
  # Elimina el directorio 'src' si existe
  - name: 'gcr.io/cloud-builders/gsutil'
    args: ['-m', 'rm', '-r', 'src']
  # Clona tu repositorio de GitHub
  - name: 'gcr.io/cloud-builders/git'
    args: ['clone', 'https://github.com/jhonmelguizo/appdemo', 'src']

  # Ejecuta el script de compilaci√≥n para generar el archivo JAR
  - name: 'gcr.io/cloud-builders/custom'
    args: ['sh', 'src/build.sh']

  # Crea la imagen Docker
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/jhonmelguizo/appdemo:$COMMIT_SHA', '.']

images:
  # Registra la imagen en Container Registry
  - 'gcr.io/jhonmelguizo/appdemo:$COMMIT_SHA'